I"–<h3 id="socketå¥—æ¥å­—">socketå¥—æ¥å­—</h3>
<blockquote>
  <p>TCP/IPåè®®ä¸­çš„TCPå’ŒUDPåè®®éƒ½é€šè¿‡å¥—æ¥å­—æ¥å®ç°ç½‘ç»œåŠŸèƒ½ã€‚å¥—æ¥å­—æ˜¯ä¸€ç§ç±»æ–‡ä»¶å¯¹è±¡ï¼Œå®ƒä½¿ç¨‹åºèƒ½æ¥å—å®¢æˆ·ç«¯çš„è¿æ¥æˆ–å»ºç«‹å¯¹å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œç”¨ä»¥å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚ä¸è®ºæ˜¯å®¢æˆ·ç«¯ç¨‹åºè¿˜æ˜¯æœåŠ¡å™¨ç«¯ç¨‹åºï¼Œä¸ºäº†è¿›è¡Œç½‘ç»œé€šä¿¡ï¼Œéƒ½è¦åˆ›å»ºå¥—æ¥å­—å¯¹è±¡ã€‚</p>
</blockquote>

<p>pythonæä¾›äº†ä¸¤ä¸ªåŸºæœ¬çš„ socket æ¨¡å—ã€‚</p>
<ul>
  <li>ç¬¬ä¸€ä¸ªæ˜¯ Socketï¼Œå®ƒæä¾›äº†æ ‡å‡†çš„ BSD Sockets APIã€‚</li>
  <li>ç¬¬äºŒä¸ªæ˜¯ SocketServerï¼Œå®ƒæä¾›äº†æœåŠ¡å™¨ä¸­å¿ƒç±»ï¼Œå¯ä»¥ç®€åŒ–ç½‘ç»œæœåŠ¡å™¨çš„å¼€å‘</li>
</ul>

<h3 id="socketæµç¨‹">Socketæµç¨‹</h3>
<p><img src="https://blog-1258233124.cos.ap-beijing.myqcloud.com/socket.png" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°" />
<img src="https://blog-1258233124.cos.ap-beijing.myqcloud.com/socket1.png" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°" /></p>

<h3 id="socket-å‡½æ•°">Socket å‡½æ•°</h3>

<ul>
  <li>1ï¼‰TCPå‘é€æ•°æ®æ—¶ï¼Œå·²å»ºç«‹å¥½TCPè¿æ¥ï¼Œæ‰€ä»¥ä¸éœ€è¦æŒ‡å®šåœ°å€ã€‚UDPæ˜¯é¢å‘æ— è¿æ¥çš„ï¼Œæ¯æ¬¡å‘é€è¦æŒ‡å®šæ˜¯å‘ç»™è°ã€‚</li>
  <li>2ï¼‰æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä¸èƒ½ç›´æ¥å‘é€åˆ—è¡¨ï¼Œå…ƒç»„ï¼Œå­—å…¸ã€‚éœ€è¦å­—ç¬¦ä¸²åŒ–repr(data)ã€‚</li>
</ul>

<h3 id="socketç¼–ç¨‹æ€è·¯">socketç¼–ç¨‹æ€è·¯</h3>
<p><img src="https://blog-1258233124.cos.ap-beijing.myqcloud.com/socket2.png" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°" /></p>

<h3 id="ç”¨socketå»ºç«‹åŸºäºtcpåè®®çš„æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ç¨‹åº">ç”¨socketå»ºç«‹åŸºäºTCPåè®®çš„æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ç¨‹åº</h3>
<h4 id="tcpæœåŠ¡ç«¯">TCPæœåŠ¡ç«¯ï¼š</h4>

<ul>
  <li>1 åˆ›å»ºå¥—æ¥å­—ï¼Œç»‘å®šå¥—æ¥å­—åˆ°æœ¬åœ°IPä¸ç«¯å£   #socket.socket(socket.AF_INET,socket.SOCK_STREAM) , s.bind()</li>
  <li>2 å¼€å§‹ç›‘å¬è¿æ¥   #s.listen()</li>
  <li>3 è¿›å…¥å¾ªç¯ï¼Œä¸æ–­æ¥å—å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚   #s.accept()</li>
  <li>4 ç„¶åæ¥æ”¶ä¼ æ¥çš„æ•°æ®ï¼Œå¹¶å‘é€ç»™å¯¹æ–¹æ•°æ® #s.recv() , s.sendall()</li>
  <li>5 ä¼ è¾“å®Œæ¯•åï¼Œå…³é—­å¥—æ¥å­—     #s.close()</li>
</ul>

<h4 id="tcpå®¢æˆ·ç«¯">TCPå®¢æˆ·ç«¯:</h4>

<ul>
  <li>1 åˆ›å»ºå¥—æ¥å­—ï¼Œè¿æ¥è¿œç«¯åœ°å€#socket.socket(socket.AF_INET,socket.SOCK_STREAM) , s.connect()</li>
  <li>2 è¿æ¥åå‘é€æ•°æ®å’Œæ¥æ”¶æ•°æ®          # s.sendall(), s.recv()</li>
  <li>3 ä¼ è¾“å®Œæ¯•åï¼Œå…³é—­å¥—æ¥å­—          #s.close()</li>
</ul>

<h4 id="ç”¨socketå»ºç«‹æœåŠ¡å™¨ç«¯ç¨‹åº">ç”¨socketå»ºç«‹æœåŠ¡å™¨ç«¯ç¨‹åº</h4>

<blockquote>
  <p>åœ¨pythonæ ‡å‡†åº“ä¸­ï¼Œä½¿ç”¨socketæ¨¡å—ä¸­æä¾›çš„socketå¯¹è±¡ï¼Œå°±å¯ä»¥åœ¨è®¡ç®—æœºç½‘ç»œä¸­å»ºç«‹æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ï¼Œå¹¶èƒ½å¤Ÿè¿›è¡Œé€šä¿¡ã€‚æœåŠ¡å™¨ç«¯éœ€è¦å»ºç«‹ä¸€ä¸ªsocketå¯¹è±¡ï¼Œå¹¶ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥ã€‚ä¸€æ—¦è¿æ¥æˆåŠŸï¼Œå°±å¯ä»¥è¿›è¡Œé€šä¿¡äº†ã€‚</p>
</blockquote>

<p>socket_server.py</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import socket
HOST=''
PORT=10888
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.bind((HOST,PORT))
s.listen(1)
conn,addr=s.accept()
print('address:',addr)
while True:
    data=conn.recv(1024)
    if not data:
        break
    print('receive data:',data.decode('utf-8'))
    conn.send(data)
conn.close()
</code></pre></div></div>

<p>socket_client.py</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import socket
HOST='localhost'
PORT=10888
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((HOST,PORT))
data='hello'
while data:
    s.sendall(data.encode('utf-8'))
    data=s.recv(512)
    print('receive from server',data.decode('utf-8'))
    data=input('è¾“å…¥æ¶ˆæ¯')
s.close()
</code></pre></div></div>
<h3 id="ç”¨socketå»ºç«‹åŸºäºudpåè®®çš„æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ç¨‹åº">ç”¨socketå»ºç«‹åŸºäºUDPåè®®çš„æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ç¨‹åº</h3>

<blockquote>
  <p>åŸºäºUDPåè®®çš„æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯åœ¨è¿›è¡Œæ•°æ®ä¼ é€æ—¶ï¼Œä¸æ˜¯å…ˆå»ºç«‹è¿æ¥ï¼Œè€Œæ˜¯ç›´æ¥è¿›è¡Œæ•°æ®ä¼ é€ã€‚</p>
</blockquote>

<p>socket_udp_server.py</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import socket
tmp=('127.0.0.1',3000)
s=socket.socket(socket.AF_INET,socket.SOCK_DGRAM)
s.bind(tmp)
data=True
while data:
    data,address=s.recvfrom(1024)
    if data=='bye':
        break
    print('receive string:',data.decode('utf-8'))
    s.sendto(data,address)
s.close()
</code></pre></div></div>

<p>socket_udp_client.py</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import socket
HOST='localhost'
PORT=3000
s=socket.socket(socket.AF_INET,socket.SOCK_DGRAM)
data='hello'
while data:
    s.sendto(data.encode('utf-8'),(HOST,PORT))
    if data=='bye':
        break
    data,addr=s.recvfrom(512)
    print('receive from server:',data.decode('utf-8'))
    data=input('è¾“å…¥æ¶ˆæ¯')
s.close()
</code></pre></div></div>

<h3 id="ç”¨socketserveræ¨¡å—å»ºç«‹æœåŠ¡å™¨">ç”¨socketserveræ¨¡å—å»ºç«‹æœåŠ¡å™¨</h3>

<blockquote>
  <p>socketæ¨¡å—å¯ä»¥åˆ›å»ºæœåŠ¡å™¨ï¼Œä½†ç¨‹åºå‘˜è¦å¯¹åŒ…æ‹¬ç½‘ç»œè¿æ¥ç­‰è¿›è¡Œç®¡ç†å’Œç¼–ç¨‹ã€‚ä¸ºäº†æ›´åŠ æ–¹ä¾¿çš„åˆ›å»ºç½‘ç»œæœåŠ¡å™¨ï¼Œpythonæ ‡å‡†åº“ä¸­æä¾›äº†ä¸€ä¸ªåˆ›å»ºç½‘ç»œæœåŠ¡å™¨çš„æ¡†æ¶â€” socketserverã€‚</p>
</blockquote>

<blockquote>
  <p>socketserverå°†å¤„ç†è¯·æ±‚åˆ’åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸ºåº”ç”¨æœåŠ¡å™¨ç±»å’Œè¯·æ±‚å¤„ç†ç±»ã€‚æœåŠ¡å™¨ç±»å¤„ç†é€šä¿¡é—®é¢˜ï¼Œè¯·æ±‚å¤„ç†ç±»å¤„ç†æ•°æ®çš„äº¤æ¢æˆ–ä¼ é€’ã€‚</p>

  <p>Â Socketserveræ¨¡å—å¯ä»¥ç®€åŒ–ç½‘ç»œæœåŠ¡å™¨çš„ç¼–å†™ï¼Œå®ƒåŒ…å«äº†å››ç§æœåŠ¡å™¨ç±»ï¼ŒTCPServerä½¿ç”¨TCPåè®®ï¼ŒUDPServerä½¿ç”¨UDPåè®®ï¼Œè¿˜æœ‰ä¸¤ä¸ªä¸å¸¸ä½¿ç”¨çš„ï¼Œå³UnixStreamServerå’ŒUnixDatagramServer,è¿™ä¸¤ä¸ªç±»ä»…ä»…åœ¨unixç¯å¢ƒä¸‹æœ‰ç”¨</p>

  <p>ä½¿ç”¨æœåŠ¡å™¨ç¼–ç¨‹ï¼Œéœ€è¦è¿›è¡Œä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼Œé¦–å…ˆå»ºç«‹ä¸€ä¸ªè¯·æ±‚å¥æŸ„ç±»ï¼Œè¿™ä¸ªç±»ç»§æ‰¿è‡ªBaseRequestHandlerç±»ï¼Œå»ºç«‹è¿™ä¸ªç±»åé‡å†™å®ƒçš„handleæ–¹æ³•ï¼Œç„¶åå®ä¾‹åŒ–æœåŠ¡å™¨ç±»ï¼ŒæŠŠä¸»æœºåï¼Œç«¯å£å·å’Œå¥æŸ„ç±»ä¼ ç»™å®ƒï¼Œç„¶åè°ƒç”¨server_forever()æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ã€‚</p>
</blockquote>

<p>socketserver.py</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import socketserver
from socketserver import TCPServer,StreamRequestHandler
HOST=''
PORT=10888
class MyTcpHandler(socketserver.StreamRequestHandler):
    def handle(self):
        while True:
            data=self.request.recv(1024)
            if not data:
                server.shutdown()
                break
            print('receive data:',data.decode('utf-8'))
            self.request.send(data)
        return
server=TCPServer((HOST,PORT),MyTcpHandler)
server.serve_forever()
</code></pre></div></div>
:ET