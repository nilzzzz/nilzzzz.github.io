I"Ë<p><a href="https://github.com/lanxuezaipiao/ReadingNotes/blob/master/Javaè¯»ä¹¦ç¬”è®°">ç‚¹å‡»æŸ¥çœ‹åŸæ–‡é“¾æ¥</a></p>
<h3 id="1-javaä¸­çš„å¤šæ€æ€§ç†è§£æ³¨æ„ä¸cåŒºåˆ†">1. Javaä¸­çš„å¤šæ€æ€§ç†è§£ï¼ˆæ³¨æ„ä¸C++åŒºåˆ†ï¼‰</h3>

<p>Javaä¸­é™¤äº†staticæ–¹æ³•å’Œfinalæ–¹æ³•ï¼ˆprivateæ–¹æ³•æœ¬è´¨ä¸Šå±äºfinalæ–¹æ³•ï¼Œå› ä¸ºä¸èƒ½è¢«å­ç±»è®¿é—®ï¼‰ä¹‹å¤–ï¼Œå…¶å®ƒæ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯åŠ¨æ€ç»‘å®šï¼Œ
è¿™æ„å‘³ç€é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸å¿…åˆ¤å®šæ˜¯å¦åº”è¯¥è¿›è¡ŒåŠ¨æ€ç»‘å®šâ€”å®ƒä¼šè‡ªåŠ¨å‘ç”Ÿã€‚
finalæ–¹æ³•ä¼šä½¿ç¼–è¯‘å™¨ç”Ÿæˆæ›´æœ‰æ•ˆçš„ä»£ç ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¯´å£°æ˜ä¸ºfinalæ–¹æ³•èƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜æ€§èƒ½ï¼ˆæ•ˆæœä¸æ˜æ˜¾ï¼‰ã€‚
å¦‚æœæŸä¸ªæ–¹æ³•æ˜¯é™æ€çš„ï¼Œå®ƒçš„è¡Œä¸ºå°±ä¸å…·æœ‰å¤šæ€æ€§</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class StaticSuper {
	public static String staticGet() {
		return "Base staticGet()";
	}
	
	public String dynamicGet() {
		return "Base dynamicGet()";
	}
}

class StaticSub extends StaticSuper {
	public static String staticGet() {
		return "Derived staticGet()";
	}
	
	public String dynamicGet() {
		return "Derived dynamicGet()";
	}
}

public class StaticPolymorphism {
	
	public static void main(String[] args) {
		StaticSuper sup = new StaticSub();
		System.out.println(sup.staticGet());
		System.out.println(sup.dynamicGet());
	}

}
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  è¾“å‡ºï¼š
Base staticGet() Derived dynamicGet()
</code></pre></div></div>
<p><strong>æ„é€ å‡½æ•°å¹¶ä¸å…·æœ‰å¤šæ€æ€§ï¼Œå®ƒä»¬å®é™…ä¸Šæ˜¯staticæ–¹æ³•ï¼Œåªä¸è¿‡è¯¥staticå£°æ˜æ˜¯éšå¼çš„.</strong>  å› æ­¤ï¼Œæ„é€ å‡½æ•°ä¸èƒ½å¤Ÿè¢«<strong>override</strong>ã€‚</p>

<p>åœ¨çˆ¶ç±»æ„é€ å‡½æ•°å†…éƒ¨è°ƒç”¨å…·æœ‰å¤šæ€è¡Œä¸ºçš„å‡½æ•°å°†å¯¼è‡´æ— æ³•é¢„æµ‹çš„ç»“æœï¼Œå› ä¸ºæ­¤æ—¶å­ç±»å¯¹è±¡è¿˜æ²¡åˆå§‹åŒ–ï¼Œæ­¤æ—¶è°ƒç”¨å­ç±»æ–¹æ³•ä¸ä¼šå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Glyph {
	void draw() {
		System.out.println("Glyph.draw()");
	}
	Glyph() {
		System.out.println("Glyph() before draw()");
		draw();
		System.out.println("Glyph() after draw()");
	}
}

class RoundGlyph extends Glyph {
	private int radius = 1;
	
	RoundGlyph(int r) {
		radius = r;
		System.out.println("RoundGlyph.RoundGlyph(). radius = " + radius);
	}
	
	void draw() {
		System.out.println("RoundGlyph.draw(). radius = " + radius);
	}
}

public class PolyConstructors {
	public static void main(String[] args) {
		new RoundGlyph(5);
	}
}

è¾“å‡ºï¼š
Glyph() before draw() RoundGlyph.draw(). radius = 0 Glyph() after draw() RoundGlyph.RoundGlyph(). radius = 5

</code></pre></div></div>
<p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·è¾“å‡ºï¼Ÿè¿™å°±è¦æ˜ç¡®æŒæ¡Javaä¸­æ„é€ å‡½æ•°çš„è°ƒç”¨é¡ºåºï¼š</p>

<blockquote>
  <ul>
    <li>ï¼ˆ1ï¼‰åœ¨å…¶ä»–ä»»ä½•äº‹ç‰©å‘ç”Ÿä¹‹å‰ï¼Œå°†åˆ†é…ç»™å¯¹è±¡çš„å­˜å‚¨ç©ºé—´åˆå§‹åŒ–æˆäºŒè¿›åˆ¶0ï¼›</li>
    <li>ï¼ˆ2ï¼‰è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°ã€‚ä»æ ¹å¼€å§‹é€’å½’ä¸‹å»ï¼Œå› ä¸ºå¤šæ€æ€§æ­¤æ—¶è°ƒç”¨å­ç±»è¦†ç›–åçš„draw()æ–¹æ³•ï¼ˆè¦åœ¨è°ƒç”¨RoundGlyphæ„é€ å‡½æ•°ä¹‹å‰è°ƒç”¨ï¼‰ï¼Œç”±äºæ­¥éª¤1çš„ç¼˜æ•…ï¼Œæˆ‘ä»¬æ­¤æ—¶ä¼šå‘ç°radiusçš„å€¼ä¸º0ï¼›</li>
    <li>ï¼ˆ3ï¼‰æŒ‰å£°æ˜é¡ºåºè°ƒç”¨æˆå‘˜çš„åˆå§‹åŒ–æ–¹æ³•ï¼›</li>
    <li>ï¼ˆ4ï¼‰æœ€åè°ƒç”¨å­ç±»çš„æ„é€ å‡½æ•°ã€‚
åªæœ‰éprivateæ–¹æ³•æ‰å¯ä»¥è¢«è¦†ç›–ï¼Œä½†æ˜¯è¿˜éœ€è¦å¯†åˆ‡æ³¨æ„è¦†ç›–privateæ–¹æ³•çš„ç°è±¡ï¼Œè¿™æ—¶è™½ç„¶ç¼–è¯‘å™¨ä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ä¹Ÿä¸ä¼šæŒ‰ç…§æˆ‘ä»¬æ‰€æœŸæœ›çš„æ¥æ‰§è¡Œï¼Œ
å³è¦†ç›–privateæ–¹æ³•å¯¹å­ç±»æ¥è¯´æ˜¯ä¸€ä¸ªæ–°çš„æ–¹æ³•è€Œéé‡è½½æ–¹æ³•ã€‚å› æ­¤ï¼Œåœ¨å­ç±»ä¸­ï¼Œæ–°æ–¹æ³•åæœ€å¥½ä¸è¦ä¸åŸºç±»çš„privateæ–¹æ³•é‡‡å–åŒä¸€åå­—ï¼ˆè™½ç„¶æ²¡å…³ç³»ï¼Œä½†å®¹æ˜“è¯¯è§£ï¼Œä»¥ä¸ºèƒ½å¤Ÿè¦†ç›–åŸºç±»çš„privateæ–¹æ³•ï¼‰ã€‚</li>
  </ul>
</blockquote>

<p>Javaç±»ä¸­å±æ€§åŸŸçš„è®¿é—®æ“ä½œéƒ½ç”±ç¼–è¯‘å™¨è§£æï¼Œå› æ­¤ä¸æ˜¯å¤šæ€çš„ã€‚çˆ¶ç±»å’Œå­ç±»çš„åŒåå±æ€§éƒ½ä¼šåˆ†é…ä¸åŒçš„å­˜å‚¨ç©ºé—´ï¼Œå¦‚ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Direct field access is determined at compile time.
class Super {
	public int field = 0;
	public int getField() {
		return field;
	}
}

class Sub extends Super {
	public int field = 1;
	public int getField() {
		return field;
	}
	public int getSuperField() {
		return super.field;
	}
}

public class FieldAccess {

	public static void main(String[] args) {
		Super sup = new Sub();
		System.out.println("sup.filed = " + sup.field + 
				", sup.getField() = " + sup.getField());
		Sub sub = new Sub();
		System.out.println("sub.filed = " + sub.field + 
				", sub.getField() = " + sub.getField() + 
				", sub.getSuperField() = " + sub.getSuperField());
	}

}
è¾“å‡ºï¼š

sup.filed = 0, sup.getField() = 1 sub.filed = 1, sub.getField() = 1, sub.getSuperField() = 0
</code></pre></div></div>
<p>Subå­ç±»å®é™…ä¸Š <strong>åŒ…å«äº†ä¸¤ä¸ªç§°ä¸ºfieldçš„åŸŸ</strong>ï¼Œç„¶è€Œåœ¨å¼•ç”¨Subä¸­çš„fieldæ—¶æ‰€äº§ç”Ÿçš„é»˜è®¤åŸŸå¹¶éSuperç‰ˆæœ¬çš„fieldåŸŸï¼Œå› æ­¤ä¸ºäº†å¾—åˆ°Super.fieldï¼Œå¿…é¡» <strong>æ˜¾å¼åœ°æŒ‡æ˜</strong> super.fieldã€‚</p>
<h3 id="2-is-aå…³ç³»å’Œis-like-aå…³ç³»">2. is-aå…³ç³»å’Œis-like-aå…³ç³»</h3>

<p>is-aå…³ç³»å±äºçº¯ç»§æ‰¿ï¼Œå³åªæœ‰åœ¨åŸºç±»ä¸­å·²ç»å»ºç«‹çš„æ–¹æ³•æ‰å¯ä»¥åœ¨å­ç±»ä¸­è¢«è¦†ç›–ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š <img src="https://blog-1258233124.cos.ap-beijing.myqcloud.com/readnote1.png" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°" /></p>

<p>åŸºç±»å’Œå­ç±»æœ‰ç€å®Œå…¨ç›¸åŒçš„æ¥å£ï¼Œè¿™æ ·å‘ä¸Šè½¬å‹æ—¶æ°¸è¿œä¸éœ€è¦çŸ¥é“æ­£åœ¨å¤„ç†çš„å¯¹è±¡çš„ç¡®åˆ‡ç±»å‹ï¼Œè¿™é€šè¿‡å¤šæ€æ¥å®ç°ã€‚</p>

<p>is-like-aå…³ç³»ï¼šå­ç±»æ‰©å±•äº†åŸºç±»æ¥å£ã€‚å®ƒæœ‰ç€ç›¸åŒçš„åŸºæœ¬æ¥å£ï¼Œä½†æ˜¯ä»–è¿˜å…·æœ‰ç”±é¢å¤–æ–¹æ³•å®ç°çš„å…¶ä»–ç‰¹æ€§ã€‚
<img src="https://blog-1258233124.cos.ap-beijing.myqcloud.com/readnote2.png" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°" /></p>

<p>ç¼ºç‚¹å°±æ˜¯å­ç±»ä¸­æ¥å£çš„æ‰©å±•éƒ¨åˆ†ä¸èƒ½è¢«åŸºç±»è®¿é—®ï¼Œå› æ­¤ä¸€æ—¦å‘ä¸Šè½¬å‹ï¼Œå°±ä¸èƒ½è°ƒç”¨é‚£äº›æ–°æ–¹æ³•ã€‚</p>

<h3 id="3-è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯rtti--åå°„">3. è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ï¼ˆRTTI + åå°„ï¼‰</h3>

<p>æ¦‚å¿µ <strong>RTTI</strong>ï¼šè¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ä½¿å¾—ä½ å¯ä»¥åœ¨ç¨‹åºè¿è¡Œæ—¶å‘ç°å’Œä½¿ç”¨ç±»å‹ä¿¡æ¯ã€‚</p>

<p>ä½¿ç”¨æ–¹å¼ Javaæ˜¯å¦‚ä½•è®©æˆ‘ä»¬åœ¨è¿è¡Œæ—¶è¯†åˆ«å¯¹è±¡å’Œç±»çš„ä¿¡æ¯çš„ï¼Œä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼ˆè¿˜æœ‰è¾…åŠ©çš„ç¬¬ä¸‰ç§æ–¹å¼ï¼Œè§ä¸‹æè¿°ï¼‰ï¼š</p>

<p>ä¸€ç§æ˜¯â€œä¼ ç»Ÿçš„â€RTTIï¼Œå®ƒå‡å®šæˆ‘ä»¬åœ¨ç¼–è¯‘æ—¶å·²ç»çŸ¥é“äº†æ‰€æœ‰çš„ç±»å‹ï¼Œæ¯”å¦‚Shape s = (Shape)s1ï¼›
å¦ä¸€ç§æ˜¯<strong>â€œåå°„â€æœºåˆ¶</strong>ï¼Œå®ƒè¿è¡Œæˆ‘ä»¬åœ¨è¿è¡Œæ—¶å‘ç°å’Œä½¿ç”¨ç±»çš„ä¿¡æ¯ï¼Œå³ä½¿ç”¨Class.forName()ã€‚
å…¶å®è¿˜æœ‰ç¬¬ä¸‰ç§å½¢å¼ï¼Œå°±æ˜¯å…³é”®å­—instanceofï¼Œå®ƒè¿”å›ä¸€ä¸ªboolå€¼ï¼Œå®ƒä¿æŒäº†ç±»å‹çš„æ¦‚å¿µï¼Œå®ƒæŒ‡çš„æ˜¯<strong>â€œä½ æ˜¯è¿™ä¸ªç±»å—ï¼Ÿæˆ–è€…ä½ æ˜¯è¿™ä¸ªç±»çš„æ´¾ç”Ÿç±»å—ï¼Ÿâ€</strong>ã€‚è€Œå¦‚æœç”¨==æˆ–equalsæ¯”è¾ƒå®é™…çš„Classå¯¹è±¡ï¼Œå°±æ²¡æœ‰è€ƒè™‘ç»§æ‰¿â€”å®ƒæˆ–è€…æ˜¯è¿™ä¸ªç¡®åˆ‡çš„ç±»å‹ï¼Œæˆ–è€…ä¸æ˜¯ã€‚
<strong>å·¥ä½œåŸç†</strong> è¦ç†è§£RTTIåœ¨Javaä¸­çš„å·¥ä½œåŸç†ï¼Œé¦–å…ˆå¿…é¡»çŸ¥é“ç±»å‹ä¿¡æ¯åœ¨è¿è¡Œæ—¶æ˜¯å¦‚ä½•è¡¨ç¤ºçš„ï¼Œè¿™é¡¹å·¥ä½œæ˜¯ç”±ç§°ä¸ºClasså¯¹è±¡çš„ç‰¹æ®Šå¯¹è±¡å®Œæˆçš„ï¼Œå®ƒåŒ…å«äº†ä¸ç±»æœ‰å…³çš„ä¿¡æ¯ã€‚Javaé€Classå¯¹è±¡æ¥æ‰§è¡Œå…¶RTTIï¼Œä½¿ç”¨ç±»åŠ è½½å™¨çš„å­ç³»ç»Ÿå®ç°ã€‚</p>

<p>æ— è®ºä½•æ—¶ï¼Œåªè¦ä½ æƒ³åœ¨è¿è¡Œæ—¶ä½¿ç”¨ç±»å‹ä¿¡æ¯ï¼Œå°±å¿…é¡»é¦–å…ˆè·å¾—å¯¹æ°å½“çš„Classå¯¹è±¡çš„å¼•ç”¨ï¼Œè·å–æ–¹å¼æœ‰ä¸‰ç§ï¼š</p>
<blockquote>
  <ul>
    <li>ï¼ˆ1ï¼‰å¦‚æœä½ æ²¡æœ‰æŒæœ‰è¯¥ç±»å‹çš„å¯¹è±¡ï¼Œåˆ™Class.forName()å°±æ˜¯å®ç°æ­¤åŠŸèƒ½çš„ä¾¿æ·é€”ï¼Œå› ä¸ºå®ƒä¸éœ€è¦å¯¹è±¡ä¿¡æ¯ï¼›</li>
    <li>ï¼ˆ2ï¼‰å¦‚æœä½ å·²ç»æ‹¥æœ‰äº†ä¸€ä¸ªæ„Ÿå…´è¶£çš„ç±»å‹çš„å¯¹è±¡ï¼Œé‚£å°±å¯ä»¥é€šè¿‡è°ƒç”¨getClass()æ–¹æ³•æ¥è·å–Classå¼•ç”¨äº†ï¼Œå®ƒå°†è¿”å›è¡¨ç¤ºè¯¥å¯¹è±¡çš„å®é™…ç±»å‹çš„Classå¼•ç”¨ã€‚ClassåŒ…å«å¾ˆæœ‰æœ‰ç”¨çš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼š</li>
  </ul>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java package rtti; interface HasBatteries{} interface WaterProof{} interface Shoots{}

class Toy {
	Toy() {}
	Toy(int i) {}
}

class FancyToy extends Toy
implements HasBatteries, WaterProof, Shoots {
	FancyToy() {
		super(1);
	}
}

public class RTTITest {
	
	static void printInfo(Class cc) {
		System.out.println("Class name: " + cc.getName() + 
				", is interface? [" + cc.isInterface() + "]");
		System.out.println("Simple name: " + cc.getSimpleName());
		System.out.println("Canonical name: " + cc.getCanonicalName());
	}
	
	public static void main(String[] args) {
		Class c = null;
		try {
			c = Class.forName("rtti.FancyToy"); // å¿…é¡»æ˜¯å…¨é™å®šåï¼ˆåŒ…å+ç±»åï¼‰
		} catch(ClassNotFoundException e) {
			System.out.println("Can't find FancyToy");
			System.exit(1);
		}
		printInfo(c);
		
		for(Class face : c.getInterfaces()) {
			printInfo(face);
		}
		
		Class up = c.getSuperclass();
		Object obj = null;
		try {
			// Requires default constructor.
			obj = up.newInstance();
		} catch (InstantiationException e) {
			System.out.println("Can't Instantiate");
			System.exit(1);
		} catch (IllegalAccessException e) {
			System.out.println("Can't access");
			System.exit(1);
		}
		printInfo(obj.getClass());
	}

}
</code></pre></div></div>

<p>è¾“å‡ºï¼š</p>

<p>Class name: rtti.FancyToy, is interface? [false] Simple name: FancyToy Canonical name: rtti.FancyToy Class name: rtti.HasBatteries, is interface? [true] Simple name: HasBatteries Canonical name: rtti.HasBatteries Class name: rtti.WaterProof, is interface? [true] Simple name: WaterProof Canonical name: rtti.WaterProof Class name: rtti.Shoots, is interface? [true] Simple name: Shoots Canonical name: rtti.Shoots Class name: rtti.Toy, is interface? [false] Simple name: Toy Canonical name: rtti.Toy</p>

<blockquote>
  <p>*ï¼ˆ3ï¼‰Javaè¿˜æä¾›äº†å¦ä¸€ç§æ–¹æ³•æ¥ç”Ÿæˆå¯¹Classå¯¹è±¡çš„å¼•ç”¨ï¼Œå³ä½¿ç”¨ç±»å­—é¢å¸¸é‡ã€‚æ¯”å¦‚ä¸Šé¢çš„å°±åƒè¿™æ ·ï¼šFancyToy.class;æ¥å¼•ç”¨ã€‚ è¿™æ ·åšä¸ä»…æ›´ç®€å•ï¼Œè€Œä¸”æ›´å®‰å…¨ï¼Œå› ä¸ºå®ƒåœ¨ç¼–è¯‘æ—¶å°±ä¼šå—åˆ°æ£€æŸ¥ï¼ˆå› æ­¤ä¸éœ€è¦ç½®äºtryè¯­å¥å—ä¸­ï¼‰ï¼Œå¹¶ä¸”å®ƒæ ¹é™¤äº†å¯¹forNameæ–¹æ³•çš„å¼•ç”¨ï¼Œæ‰€ä»¥ä¹Ÿæ›´é«˜æ•ˆã€‚ç±»å­—é¢å¸¸é‡ä¸ä»…å¯ä»¥åº”ç”¨äºæ™®é€šçš„ç±»ï¼Œä¹Ÿå¯ä»¥åº”ç”¨äºæ¥å£ã€æ•°ç»„ä»¥åŠåŸºæœ¬æ•°æ®ç±»å‹ã€‚</p>
</blockquote>

<p><strong>æ³¨æ„</strong>ï¼šå½“ä½¿ç”¨â€œ.classâ€æ¥åˆ›å»ºå¯¹Classå¯¹è±¡çš„å¼•ç”¨æ—¶ï¼Œä¸ä¼šè‡ªåŠ¨åœ°åˆå§‹åŒ–è¯¥Classå¯¹è±¡ï¼Œåˆå§‹åŒ–è¢«å»¶è¿Ÿåˆ°äº†å¯¹é™æ€æ–¹æ³•ï¼ˆæ„é€ å™¨éšå¼çš„æ˜¯é™æ€çš„ï¼‰æˆ–è€…éfinalé™æ€åŸŸï¼ˆæ³¨æ„finalé™æ€åŸŸä¸ä¼šè§¦å‘åˆå§‹åŒ–æ“ä½œï¼‰è¿›è¡Œé¦–æ¬¡å¼•ç”¨æ—¶æ‰æ‰§è¡Œï¼šã€‚è€Œä½¿ç”¨Class.forNameæ—¶ä¼šè‡ªåŠ¨çš„åˆå§‹åŒ–ã€‚</p>

<p>ä¸ºäº†ä½¿ç”¨ç±»è€Œåšçš„å‡†å¤‡å·¥ä½œå®é™…åŒ…å«ä¸‰ä¸ªæ­¥éª¤ï¼š</p>

<blockquote>
  <ul>
    <li><strong>åŠ è½½</strong>ï¼šç”±ç±»åŠ è½½å™¨æ‰§è¡Œã€‚æŸ¥æ‰¾å­—èŠ‚ç ï¼Œå¹¶ä»è¿™äº›å­—èŠ‚ç ä¸­åˆ›å»ºä¸€ä¸ªClasså¯¹è±¡</li>
    <li><strong>é“¾æ¥</strong>ï¼šéªŒè¯ç±»ä¸­çš„å­—èŠ‚ç ï¼Œä¸ºé™æ€åŸŸåˆ†é…å­˜å‚¨ç©ºé—´ï¼Œå¹¶ä¸”å¦‚æœå¿…éœ€çš„è¯ï¼Œå°†è§£æè¿™ä¸ªç±»åˆ›å»ºçš„å¯¹å…¶ä»–ç±»çš„æ‰€æœ‰å¼•ç”¨ã€‚</li>
    <li><strong>åˆå§‹åŒ–</strong>ï¼šå¦‚æœè¯¥ç±»å…·æœ‰è¶…ç±»ï¼Œåˆ™å¯¹å…¶åˆå§‹åŒ–ï¼Œæ‰§è¡Œé™æ€åˆå§‹åŒ–å™¨å’Œé™æ€åˆå§‹åŒ–å—ã€‚
è¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼Œä¸‹é¢é€šè¿‡ä¸€ä¸ªå®ä¾‹æ¥è¯´æ˜è¿™ä¸¤è€…çš„åŒºåˆ«ï¼š</li>
  </ul>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">rtti</span><span class="p">;</span>
<span class="n">import</span> <span class="n">java</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">Random</span><span class="p">;</span>
<span class="n">class</span> <span class="n">Initable</span> <span class="p">{</span>
    	<span class="n">static</span> <span class="n">final</span> <span class="n">int</span> <span class="n">staticFinal</span> <span class="p">=</span> <span class="m">47</span><span class="p">;</span>
    	<span class="n">static</span> <span class="n">final</span> <span class="n">int</span> <span class="n">staticFinal2</span> <span class="p">=</span> <span class="n">ClassInitialization</span><span class="p">.</span><span class="n">rand</span><span class="p">.</span><span class="n">nextInt</span><span class="p">(</span><span class="m">1000</span><span class="p">);</span>
	
    	<span class="n">static</span> <span class="p">{</span>
    		<span class="nf">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"Initializing Initable"</span><span class="p">);</span>
    	<span class="p">}</span>
<span class="p">}</span>
<span class="n">class</span> <span class="n">Initable2</span> <span class="p">{</span>
    	<span class="n">static</span> <span class="n">int</span> <span class="n">staticNonFinal</span> <span class="p">=</span> <span class="m">147</span><span class="p">;</span>
    	
    	<span class="n">static</span> <span class="p">{</span>
    		<span class="nf">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"Initializing Initable2"</span><span class="p">);</span>
    	<span class="p">}</span>
<span class="p">}</span>
<span class="n">class</span> <span class="n">Initable3</span> <span class="p">{</span>
    	<span class="n">static</span> <span class="n">int</span> <span class="n">staticNonFinal</span> <span class="p">=</span> <span class="m">74</span><span class="p">;</span>
    	
    	<span class="n">static</span> <span class="p">{</span>
    		<span class="nf">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"Initializing Initable3"</span><span class="p">);</span>
    	<span class="p">}</span>
<span class="p">}</span>
<span class="k">public</span> <span class="n">class</span> <span class="n">ClassInitialization</span> <span class="p">{</span>

    	<span class="k">public</span> <span class="n">static</span> <span class="n">Random</span> <span class="n">rand</span> <span class="p">=</span> <span class="n">new</span> <span class="n">Random</span><span class="p">(</span><span class="m">47</span><span class="p">);</span>
    	
    	<span class="k">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="p">(</span><span class="k">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span> <span class="p">{</span>
    		<span class="p">//</span> <span class="n">Does</span> <span class="k">not</span> <span class="n">trigger</span> <span class="n">initialization</span>
    		<span class="n">Class</span> <span class="n">initable</span> <span class="p">=</span> <span class="n">Initable</span><span class="p">.</span><span class="n">class</span><span class="p">;</span>
    		<span class="nf">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"After creating Initable ref"</span><span class="p">);</span>
    		<span class="p">//</span> <span class="n">Does</span> <span class="k">not</span> <span class="n">trigger</span> <span class="n">initialization</span>
    		<span class="nf">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">Initable</span><span class="p">.</span><span class="n">staticFinal</span><span class="p">);</span>
    		<span class="p">//</span> <span class="n">Does</span> <span class="n">trigger</span> <span class="n">initialization</span><span class="p">(</span><span class="n">rand</span><span class="p">()</span> <span class="n">is</span> <span class="n">static</span> <span class="n">method</span><span class="p">)</span>
    		<span class="nf">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">Initable</span><span class="p">.</span><span class="n">staticFinal2</span><span class="p">);</span>
    		
    		<span class="p">//</span> <span class="n">Does</span> <span class="n">trigger</span> <span class="n">initialization</span><span class="p">(</span><span class="k">not</span> <span class="n">final</span><span class="p">)</span>
    		<span class="nf">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">Initable2</span><span class="p">.</span><span class="n">staticNonFinal</span><span class="p">);</span>
    		
    		<span class="n">try</span> <span class="p">{</span>
    			<span class="n">Class</span> <span class="n">initable3</span> <span class="p">=</span> <span class="n">Class</span><span class="p">.</span><span class="n">forName</span><span class="p">(</span><span class="s2">"rtti.Initable3"</span><span class="p">);</span>
    		<span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">ClassNotFoundException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    			<span class="nf">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"Can't find Initable3"</span><span class="p">);</span>
    			<span class="nf">System</span><span class="p">.</span><span class="k">exit</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
    		<span class="p">}</span>
    		<span class="nf">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"After creating Initable3 ref"</span><span class="p">);</span>
    		<span class="nf">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">Initable3</span><span class="p">.</span><span class="n">staticNonFinal</span><span class="p">);</span>
    	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>è¾“å‡ºï¼š</p>

<p>After creating Initable ref 47 Initializing Initable 258 Initializing Initable2 147 Initializing Initable3 After creating Initable3 ref 74</p>

<p><strong>RTTIçš„é™åˆ¶ï¼Ÿå¦‚ä½•çªç ´ï¼Ÿ</strong>  â€” <strong>åå°„æœºåˆ¶</strong> å¦‚æœä¸çŸ¥é“æŸä¸ªå¯¹è±¡çš„ç¡®åˆ‡ç±»å‹ï¼ŒRTTIå¯ä»¥å‘Šè¯‰ä½ ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé™åˆ¶ï¼šè¿™ä¸ªç±»å‹åœ¨ç¼–è¯‘æ—¶å¿…é¡»å·²çŸ¥ï¼Œè¿™æ ·æ‰èƒ½ä½¿ç”¨RTTIè¯†åˆ«å®ƒï¼Œä¹Ÿå°±æ˜¯åœ¨ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨å¿…é¡»çŸ¥é“æ‰€æœ‰è¦é€šè¿‡RTTIæ¥å¤„ç†çš„ç±»ã€‚</p>

<p>å¯ä»¥çªç ´è¿™ä¸ªé™åˆ¶å—ï¼Ÿæ˜¯çš„ï¼Œçªç ´å®ƒçš„å°±æ˜¯åå°„æœºåˆ¶ã€‚ Classç±»ä¸java.lang.reflectç±»åº“ä¸€èµ·å¯¹åå°„çš„æ¦‚å¿µè¿›è¡Œäº†æ”¯æŒï¼Œè¯¥ç±»åº“åŒ…å«äº†Fieldã€Methodä»¥åŠConstructorç±»ï¼ˆæ¯ä¸ªç±»éƒ½å®ç°äº†Memberæ¥å£ï¼‰ã€‚è¿™äº›ç±»å‹çš„å¯¹è±¡æ˜¯ç”±JVMåœ¨è¿è¡Œæ—¶åˆ›å»ºçš„ï¼Œç”¨ä»¥è¡¨ç¤ºæœªçŸ¥ç±»é‡Œå¯¹åº”çš„æˆå‘˜ã€‚è¿™æ ·ä½ å°±å¯ä»¥ä½¿ç”¨Constructoråˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œç”¨get()/set()æ–¹æ³•è¯»å–å’Œä¿®æ”¹ä¸Fieldå¯¹è±¡å…³è”çš„å­—æ®µï¼Œç”¨invoke()æ–¹æ³•è°ƒç”¨ä¸Methodå¯¹è±¡å…³è”çš„æ–¹æ³•ã€‚å¦å¤–ï¼Œè¿˜å¯ä»¥è°ƒç”¨getFields()ã€getMethods()å’ŒgetConstructors()ç­‰å¾ˆä¾¿åˆ©çš„æ–¹æ³•ï¼Œä»¥è¿”å›è¡¨ç¤ºå­—æ®µã€æ–¹æ³•ä»¥åŠæ„é€ å™¨çš„å¯¹è±¡çš„æ•°ç»„ã€‚è¿™æ ·ï¼ŒåŒ¿åå¯¹è±¡çš„ç±»ä¿¡æ¯å°±èƒ½åœ¨è¿è¡Œæ—¶è¢«å®Œå…¨ç¡®å®šä¸‹æ¥ï¼Œè€Œåœ¨ç¼–è¯‘æ—¶ä¸éœ€è¦çŸ¥é“ä»»ä½•äº‹æƒ…ã€‚</p>

<h3 id="åå°„ä¸rttiçš„åŒºåˆ«">åå°„ä¸RTTIçš„åŒºåˆ«</h3>

<p>å½“é€šè¿‡åå°„ä¸ä¸€ä¸ªæœªçŸ¥ç±»å‹çš„å¯¹è±¡æ‰“äº¤é“æ—¶ï¼ŒJVMåªæ˜¯ç®€å•åœ°æ£€æŸ¥è¿™ä¸ªå¯¹è±¡ï¼Œçœ‹å®ƒå±äºå“ªä¸ªç‰¹å®šçš„ç±»ï¼ˆå°±åƒRTTIé‚£æ ·ï¼‰ï¼Œåœ¨ç”¨å®ƒåšå…¶ä»–äº‹æƒ…ä¹‹å‰å¿…é¡»å…ˆåŠ è½½é‚£ä¸ªç±»çš„Classå¯¹è±¡ï¼Œå› æ­¤ï¼Œé‚£ä¸ªç±»çš„.classæ–‡ä»¶å¯¹äºJVMæ¥è¯´å¿…é¡»æ˜¯å¯è·å–çš„ï¼šè¦ä¹ˆåœ¨æœ¬åœ°æœºå™¨ä¸Šï¼Œè¦ä¹ˆå¯ä»¥é€šè¿‡ç½‘ç»œå–å¾—ã€‚æ‰€ä»¥RTTIä¸åå°„ä¹‹é—´çœŸæ­£çš„åŒºåˆ«åªåœ¨äºï¼šå¯¹RTTIæ¥è¯´ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶æ‰“å¼€å’Œæ£€æŸ¥.classæ–‡ä»¶ï¼ˆä¹Ÿå°±æ˜¯å¯ä»¥ç”¨æ™®é€šæ–¹æ³•è°ƒç”¨å¯¹è±¡çš„æ‰€æœ‰æ–¹æ³•ï¼‰ï¼›è€Œå¯¹äºåå°„æœºåˆ¶æ¥è¯´ï¼Œ.classæ–‡ä»¶åœ¨ç¼–è¯‘æ—¶æ˜¯ä¸å¯è·å–çš„ï¼Œæ‰€ä»¥æ˜¯åœ¨è¿è¡Œæ—¶æ‰“å¼€å’Œæ£€æŸ¥.classæ–‡ä»¶ã€‚</p>

<p>ä¸‹é¢çš„ä¾‹å­æ˜¯ç”¨åå°„æœºåˆ¶æ‰“å°å‡ºä¸€ä¸ªç±»çš„æ‰€æœ‰æ–¹æ³•ï¼ˆåŒ…æ‹¬åœ¨åŸºç±»ä¸­å®šä¹‰çš„æ–¹æ³•ï¼‰ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">typeinfo</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.reflect.Constructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.Method</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.regex.Pattern</span><span class="o">;</span>

<span class="c1">// Using reflection to show all the methods of a class.</span>
<span class="c1">// even if the methods are defined in the base class.</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ShowMethods</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="n">usage</span> <span class="o">=</span> 
		<span class="s">"usage: \n"</span> <span class="o">+</span> 
	    <span class="s">"ShowMethods qualified.class.name\n"</span> <span class="o">+</span>
	    <span class="s">"To show all methods in class or: \n"</span> <span class="o">+</span>
	    <span class="s">"ShowMethods qualified.class.name word\n"</span> <span class="o">+</span>
	    <span class="s">"To search for methods involving 'word'"</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">Pattern</span> <span class="n">p</span> <span class="o">=</span> <span class="nc">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"\\w+\\."</span><span class="o">);</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">usage</span><span class="o">);</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
		<span class="o">}</span>
		<span class="kt">int</span> <span class="n">lines</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
			<span class="nc">Method</span><span class="o">[]</span> <span class="n">methods</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">getMethods</span><span class="o">();</span>
			<span class="nc">Constructor</span><span class="o">[]</span> <span class="n">ctors</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">getConstructors</span><span class="o">();</span>
			<span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">for</span><span class="o">(</span><span class="nc">Method</span> <span class="n">method</span> <span class="o">:</span> <span class="n">methods</span><span class="o">)</span> <span class="o">{</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">toString</span><span class="o">()).</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">""</span><span class="o">));</span>
				<span class="o">}</span>
				<span class="k">for</span><span class="o">(</span><span class="nc">Constructor</span> <span class="n">ctor</span> <span class="o">:</span> <span class="n">ctors</span><span class="o">)</span> <span class="o">{</span>
					<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">ctor</span><span class="o">.</span><span class="na">toString</span><span class="o">()).</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">""</span><span class="o">));</span>
				<span class="o">}</span>
				<span class="n">lines</span> <span class="o">=</span> <span class="n">methods</span><span class="o">.</span><span class="na">length</span> <span class="o">+</span> <span class="n">ctors</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
			<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
				<span class="k">for</span><span class="o">(</span><span class="nc">Method</span> <span class="n">method</span> <span class="o">:</span> <span class="n">methods</span><span class="o">)</span> <span class="o">{</span>
					<span class="k">if</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">indexOf</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">])</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
						<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">toString</span><span class="o">()).</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">""</span><span class="o">));</span>
						<span class="n">lines</span><span class="o">++;</span>
					<span class="o">}</span>
				<span class="o">}</span>
				<span class="k">for</span><span class="o">(</span><span class="nc">Constructor</span> <span class="n">ctor</span> <span class="o">:</span> <span class="n">ctors</span><span class="o">)</span> <span class="o">{</span>
					<span class="k">if</span><span class="o">(</span><span class="n">ctor</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">indexOf</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">])</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
						<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">ctor</span><span class="o">.</span><span class="na">toString</span><span class="o">()).</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">""</span><span class="o">));</span>
						<span class="n">lines</span><span class="o">++;</span>
					<span class="o">}</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">ClassNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"No such Class: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">);</span>
		<span class="o">}</span>

	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>è¾“å‡ºï¼š</p>

<p>public static void main(String[]) public final native void wait(long) throws InterruptedException public final void wait() throws InterruptedException public final void wait(long,int) throws InterruptedException public boolean equals(Object) public String toString() public native int hashCode() public final native Class getClass() public final native void notify() public final native void notifyAll() public ShowMethods()</p>

<h3 id="4-ä»£ç†æ¨¡å¼ä¸javaä¸­çš„åŠ¨æ€ä»£ç†">4. ä»£ç†æ¨¡å¼ä¸Javaä¸­çš„åŠ¨æ€ä»£ç†</h3>

<p><strong>ä»£ç†æ¨¡å¼</strong> åœ¨ä»»ä½•æ—¶åˆ»ï¼Œåªè¦ä½ æƒ³è¦å°†é¢å¤–çš„æ“ä½œä»â€œå®é™…â€å¯¹è±¡ä¸­åˆ†ç¦»åˆ°ä¸åŒçš„åœ°æ–¹ï¼Œç‰¹åˆ«æ˜¯å½“ä½ å¸Œæœ›èƒ½å¤Ÿå¾ˆå®¹æ˜“åœ°åšå‡ºä¿®æ”¹ï¼Œä»æ²¡æœ‰ä½¿ç”¨é¢å¤–æ“ä½œè½¬ä¸ºä½¿ç”¨è¿™äº›æ“ä½œï¼Œæˆ–è€…åè¿‡æ¥æ—¶ï¼Œä»£ç†å°±æ˜¾å¾—å¾ˆæœ‰ç”¨ï¼ˆè®¾è®¡æ¨¡å¼çš„å…³é”®æ˜¯å°è£…ä¿®æ”¹ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å¸Œæœ›è·Ÿè¸ªå¯¹æŸä¸ªç±»ä¸­æ–¹æ³•çš„è°ƒç”¨ï¼Œæˆ–è€…å¸Œæœ›åº¦é‡è¿™äº›è°ƒç”¨çš„å¼€é”€ï¼Œé‚£ä¹ˆä½ åº”è¯¥æ€æ ·åšå‘¢ï¼Ÿè¿™äº›ä»£ç è‚¯å®šæ˜¯ä½ ä¸å¸Œæœ›å°†å…¶åˆå¹¶åˆ°åº”ç”¨ä¸­çš„ä»£ç ï¼Œå› æ­¤ä»£ç†ä½¿å¾—ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°æ·»åŠ æˆ–ç§»é™¤å®ƒä»¬ã€‚</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>interface Interface {
	void doSomething();
	void somethingElse(String arg);
}

class RealObject implements Interface {

	@Override
	public void doSomething() {
		System.out.println("doSomething.");
	}

	@Override
	public void somethingElse(String arg) {
		System.out.println("somethingElse " + arg);
	}
}

class SimpleProxy implements Interface {
	
	private Interface proxy;
	
	public SimpleProxy(Interface proxy) {
		this.proxy = proxy;
	}

	@Override
	public void doSomething() {
		System.out.println("SimpleProxy doSomething.");
		proxy.doSomething();
	}

	@Override
	public void somethingElse(String arg) {
		System.out.println("SimpleProxy somethingElse " + arg);
		proxy.somethingElse(arg);
	}
}

public class SimpleProxyDemo {
	
	public static void consumer(Interface iface) {
		iface.doSomething();
		iface.somethingElse("bonobo");
	}

	public static void main(String[] args) {
		consumer(new RealObject());
		consumer(new SimpleProxy(new RealObject()));
	}

}
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>è¾“å‡ºï¼š

doSomething. somethingElse bonobo SimpleProxy doSomething. doSomething. SimpleProxy somethingElse bonobo somethingElse bonobo
åŠ¨æ€ä»£ç† Javaçš„åŠ¨æ€ä»£ç†æ¯”ä»£ç†çš„æ€æƒ³æ›´å‘å‰è¿ˆè¿›äº†ä¸€æ­¥ï¼Œå› ä¸ºå®ƒå¯ä»¥åŠ¨æ€åœ°åˆ›å»ºä»£ç†å¹¶åŠ¨æ€åœ°å¤„ç†å¯¹æ‰€ä»£ç†æ–¹æ³•çš„è°ƒç”¨ã€‚
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;

class DynamicProxyHandler implements InvocationHandler {
	
	private Object proxy;
	
	public DynamicProxyHandler(Object proxy) {
		this.proxy = proxy;
	}
	
	@Override
	public Object invoke(Object proxy, Method method, Object[] args)
			throws Throwable {
		System.out.println("*** proxy: " + proxy.getClass() +
				". method: " + method + ". args: " + args);
		if(args != null) {
			for(Object arg : args)
				System.out.println(" " + arg);
		}
		return method.invoke(this.proxy, args);
	}
}

public class SimpleDynamicProxy {
	
	public static void consumer(Interface iface) {
		iface.doSomething();
		iface.somethingElse("bonobo");
	}

	public static void main(String[] args) {
		RealObject real = new RealObject();
		consumer(real);
		// insert a proxy and call again:
		Interface proxy = (Interface)Proxy.newProxyInstance(
				Interface.class.getClassLoader(), 
				new Class[]{ Interface.class },
				new DynamicProxyHandler(real));
		
		consumer(proxy);
	}

}
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>è¾“å‡ºï¼š

doSomething. somethingElse bonobo *** proxy: class typeinfo.$Proxy0. method: public abstract void typeinfo.Interface.doSomething(). args: null doSomething. *** proxy: class typeinfo.$Proxy0. method: public abstract void typeinfo.Interface.somethingElse(java.lang.String). args: [Ljava.lang.Object;@6a8814e9 bonobo somethingElse bonobo
</code></pre></div></div>

<h3 id="5-å³æ—¶ç¼–è¯‘å™¨æŠ€æœ¯--jit">5. å³æ—¶ç¼–è¯‘å™¨æŠ€æœ¯ â€” JIT</h3>

<p>Javaè™šæ‹Ÿæœºä¸­æœ‰è®¸å¤šé™„åŠ æŠ€æœ¯ç”¨ä»¥æå‡é€Ÿåº¦ï¼Œå°¤å…¶æ˜¯ä¸åŠ è½½å™¨æ“ä½œç›¸å…³çš„ï¼Œè¢«ç§°ä¸ºâ€œå³æ—¶â€ï¼ˆJust-In-Timeï¼ŒJITï¼‰ç¼–è¯‘å™¨çš„æŠ€æœ¯ã€‚<strong>è¿™ç§æŠ€æœ¯å¯ä»¥æŠŠç¨‹åºå…¨éƒ¨æˆ–éƒ¨åˆ†ç¿»è¯‘æˆæœ¬åœ°æœºå™¨ç ï¼ˆè¿™æœ¬æ¥æ˜¯JVMçš„å·¥ä½œï¼‰ï¼Œç¨‹åºè¿è¡Œé€Ÿåº¦å› æ­¤å¾—ä»¥æå‡ã€‚</strong>å½“éœ€è¦è£…è½½æŸä¸ªç±»æ—¶ï¼Œç¼–è¯‘å™¨ä¼šå…ˆæ‰¾åˆ°å…¶.classæ–‡ä»¶ï¼Œç„¶åå°†è¯¥ç±»çš„å­—èŠ‚ç è£…å…¥å†…å­˜ã€‚æ­¤æ—¶ï¼Œæœ‰ä¸¤ç§æ–¹æ¡ˆå¯ä¾›é€‰æ‹©ï¼š</p>
<blockquote>
  <ul>
    <li>ï¼ˆ1ï¼‰ä¸€ç§å°±æ˜¯è®©å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘æ‰€æœ‰ä»£ç ã€‚ä½†è¿™ç§åšæ³•æœ‰ä¸¤ä¸ªç¼ºé™·ï¼šè¿™ç§åŠ è½½åŠ¨ä½œæ•£è½åœ¨æ•´ä¸ªç¨‹åºç”Ÿå‘½å‘¨æœŸå†…ï¼Œç´¯åŠ èµ·æ¥è¦èŠ±æ›´å¤šæ—¶é—´ï¼›å¹¶ä¸”ä¼šå¢åŠ å¯æ‰§è¡Œä»£ç çš„é•¿åº¦ï¼ˆå­—èŠ‚ç è¦æ¯”å³æ—¶ç¼–è¯‘å™¨å±•å¼€åçš„æœ¬åœ°æœºå™¨ç å°å¾ˆå¤šï¼‰ï¼Œè¿™å°†å¯¼è‡´é¡µé¢è°ƒåº¦ï¼Œä»è€Œé™ä½ç¨‹åºé€Ÿåº¦ã€‚</li>
    <li>ï¼ˆ2ï¼‰å¦ä¸€ç§åšæ³•ç§°ä¸ºæƒ°æ€§è¯„ä¼°ï¼ˆlazy evaluationï¼‰ï¼Œæ„æ€æ˜¯å³æ—¶ç¼–è¯‘å™¨åªåœ¨å¿…è¦çš„æ—¶å€™æ‰ç¼–è¯‘ä»£ç ï¼Œè¿™æ ·ï¼Œä»ä¸ä¼šè¢«æ‰§è¡Œçš„ä»£ç ä¹Ÿè®¸å°±å‹æ ¹ä¸ä¼šè¢«JITæ‰€ç¼–è¯‘ã€‚æ–°ç‰ˆJDKä¸­çš„Java HotSpotæŠ€æœ¯å°±é‡‡ç”¨äº†ç±»ä¼¼æ–¹æ³•ï¼Œä»£ç æ¯æ¬¡è¢«æ‰§è¡Œçš„æ—¶å€™éƒ½ä¼šåšä¸€äº›ä¼˜åŒ–ï¼Œæ‰€ä»¥æ‰§è¡Œçš„æ¬¡æ•°è¶Šå¤šï¼Œå®ƒçš„é€Ÿåº¦å°±è¶Šå¿«ã€‚</li>
  </ul>
</blockquote>

<h3 id="6-è®¿é—®æ§åˆ¶æƒé™">6. è®¿é—®æ§åˆ¶æƒé™</h3>

<p>Javaè®¿é—®æƒé™ä¿®é¥°è¯ï¼špublicã€protectedã€åŒ…è®¿é—®æƒé™ï¼ˆé»˜è®¤è®¿é—®æƒé™ï¼Œæœ‰æ—¶ä¹Ÿç§°friendlyï¼‰å’Œprivateã€‚
åŒ…è®¿é—®æƒé™ï¼šå½“å‰åŒ…ä¸­çš„æ‰€æœ‰å…¶ä»–ç±»å¯¹é‚£ä¸ªæˆå‘˜å…·æœ‰è®¿é—®æƒé™ï¼Œä½†å¯¹äºè¿™ä¸ªåŒ…ä¹‹å¤–çš„æ‰€æœ‰ç±»ï¼Œè¿™ä¸ªæˆå‘˜å´æ˜¯privateã€‚
protectedï¼šç»§æ‰¿è®¿é—®æƒé™ã€‚æœ‰æ—¶åŸºç±»çš„åˆ›å»ºè€…ä¼šå¸Œæœ›æœ‰æŸä¸ªç‰¹å®šæˆå‘˜ï¼ŒæŠŠå¯¹å®ƒçš„è®¿é—®æƒé™èµ‹äºˆæ´¾ç”Ÿç±»è€Œä¸æ˜¯æ‰€æœ‰ç±»ã€‚è¿™å°±éœ€è¦protectedæ¥å®Œæˆè¿™ä¸€å·¥ä½œã€‚protectedä¹Ÿæä¾›åŒ…è®¿é—®æƒé™ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç›¸åŒåŒ…å†…çš„å…¶ä»–ç±»éƒ½å¯ä»¥è®¿é—®protectedå…ƒç´ ã€‚protectedæŒ‡æ˜<strong>â€œå°±ç±»ç”¨æˆ·è€Œè¨€ï¼Œè¿™æ˜¯privateçš„ï¼Œä½†å¯¹äºä»»ä½•ç»§æ‰¿äºæ­¤ç±»çš„å¯¼å‡ºç±»æˆ–å…¶ä»–ä»»ä½•ä½äºåŒä¸€ä¸ªåŒ…å†…çš„ç±»æ¥è¯´ï¼Œå®ƒå´æ˜¯å¯ä»¥è®¿é—®çš„â€</strong>ã€‚æ¯”å¦‚ï¼š åŸºç±»ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">access</span><span class="p">.</span><span class="n">cookie</span><span class="p">;</span>
<span class="k">public</span> <span class="n">class</span> <span class="n">Cookie</span> <span class="p">{</span>
    <span class="k">public</span> <span class="n">Cookie</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"Cookie Constructor"</span><span class="p">);</span>
    <span class="p">}</span>
 
    <span class="n">void</span> <span class="n">bite</span><span class="p">()</span> <span class="p">{</span>  <span class="p">//</span> <span class="err">åŒ…è®¿é—®æƒé™ï¼Œå…¶å®ƒåŒ…å³ä½¿æ˜¯å­ç±»ä¹Ÿä¸èƒ½è®¿é—®å®ƒ</span>
        <span class="nf">System</span><span class="p">.</span><span class="n">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s2">"bite"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>å­ç±»ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java package access.dessert; import access.cookie.Cookie;

public class ChocolateChip extends Cookie {

	public ChocolateChip() {
		System.out.println("ChocolateChip constructor");
	}
	
	public void chomp() {
		bite();  // error, the method bite() from the type Cookie is not visible
	}
}
</code></pre></div></div>
<p>å¯ä»¥å‘ç°å­ç±»å¹¶ä¸èƒ½è®¿é—®åŸºç±»çš„åŒ…è®¿é—®æƒé™æ–¹æ³•ã€‚æ­¤æ—¶å¯ä»¥å°†Cookieä¸­çš„biteæŒ‡å®šä¸ºpublicï¼Œä½†è¿™æ ·åšæ‰€æœ‰çš„äººå°±éƒ½æœ‰äº†è®¿é—®æƒé™ï¼Œä¸ºäº†åªå…è®¸å­ç±»è®¿é—®ï¼Œå¯ä»¥å°†biteæŒ‡å®šä¸ºprotectedå³å¯ã€‚</p>

<h3 id="7-ç»„åˆå’Œç»§æ‰¿ä¹‹é—´çš„é€‰æ‹©">7. ç»„åˆå’Œç»§æ‰¿ä¹‹é—´çš„é€‰æ‹©</h3>

<p>ç»„åˆå’Œç»§æ‰¿éƒ½å…è®¸åœ¨æ–°çš„ç±»ä¸­æ”¾ç½®å­å¯¹è±¡ï¼Œç»„åˆæ˜¯æ˜¾å¼çš„è¿™æ ·åšï¼Œè€Œç»§æ‰¿åˆ™æ˜¯éšå¼çš„åšã€‚
ç»„åˆæŠ€æœ¯é€šå¸¸ç”¨äºæƒ³åœ¨æ–°ç±»ä¸­ä½¿ç”¨ç°æœ‰ç±»çš„åŠŸèƒ½è€Œéå®ƒçš„æ¥å£è¿™ç§æƒ…å½¢ã€‚å³åœ¨æ–°ç±»ä¸­åµŒå…¥æŸä¸ªå¯¹è±¡ï¼Œè®©å…¶å®ç°æ‰€éœ€è¦çš„åŠŸèƒ½ï¼Œä½†æ–°ç±»çš„ç”¨æˆ·çœ‹åˆ°çš„åªæ˜¯ä¸ºæ–°ç±»æ‰€å®šä¹‰çš„æ¥å£ï¼Œè€Œéæ‰€åµŒå…¥å¯¹è±¡çš„æ¥å£ã€‚ä¸ºå–å¾—æ­¤æ•ˆæœï¼Œéœ€è¦åœ¨æ–°ç±»ä¸­åµŒå…¥ä¸€ä¸ªç°æœ‰ç±»çš„privateå¯¹è±¡ã€‚ä½†æœ‰æ—¶ï¼Œå…è®¸ç±»çš„ç”¨æˆ·ç›´æ¥è®¿é—®æ–°ç±»ä¸­çš„ç»„åˆæˆåˆ†æ˜¯æå…·æ„ä¹‰çš„ï¼Œå³å°†æˆå‘˜å¯¹è±¡å£°æ˜ä¸ºpublicã€‚å¦‚æœæˆå‘˜å¯¹è±¡è‡ªèº«éƒ½éšè—äº†å…·ä½“å®ç°ï¼Œé‚£ä¹ˆè¿™ç§åšæ³•æ˜¯å®‰å…¨çš„ã€‚å½“ç”¨æˆ·èƒ½å¤Ÿäº†è§£åˆ°ä½ æ­£åœ¨ç»„è£…ä¸€ç»„éƒ¨ä»¶æ—¶ï¼Œä¼šä½¿å¾—ç«¯å£æ›´åŠ æ˜“äºç†è§£ã€‚æ¯”å¦‚Carå¯¹è±¡å¯ç”±publicçš„Engineå¯¹è±¡ã€Wheelå¯¹è±¡ã€Windowå¯¹è±¡å’ŒDoorå¯¹è±¡ç»„åˆã€‚ä½†åŠ¡å¿…è¦è®°å¾—è¿™ä»…ä»…æ˜¯ä¸€ä¸ªç‰¹ä¾‹ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åº”è¯¥ä½¿åŸŸæˆä¸ºprivateã€‚
åœ¨ç»§æ‰¿çš„æ—¶å€™ï¼Œä½¿ç”¨æŸä¸ªç°æœ‰ç±»ï¼Œå¹¶å¼€å‘ä¸€ä¸ªå®ƒçš„ç‰¹æ®Šç‰ˆæœ¬ã€‚é€šå¸¸ï¼Œ<strong>è¿™æ„å‘³ç€ä½ åœ¨ä½¿ç”¨ä¸€ä¸ªé€šç”¨ç±»ï¼Œå¹¶ä¸ºäº†æŸç§ç‰¹æ®Šéœ€è¦è€Œå°†å…¶ç‰¹æ®ŠåŒ–ã€‚</strong>ç¨å¾®æ€è€ƒä¸€ä¸‹å°±ä¼šå‘ç°ï¼Œç”¨ä¸€ä¸ªâ€œäº¤é€šå·¥å…·â€å¯¹è±¡æ¥æ„æˆä¸€éƒ¨â€œè½¦å­â€æ˜¯æ¯«æ— æ„ä¹‰çš„ï¼Œå› ä¸ºâ€œè½¦å­â€å¹¶ä¸åŒ…å«â€œäº¤é€šå·¥å…·â€ï¼Œå®ƒä»…æ˜¯ä¸€ç§äº¤é€šå·¥å…·ï¼ˆis-aå…³ç³»ï¼‰ã€‚
â€œis-aâ€ï¼ˆæ˜¯ä¸€ä¸ªï¼‰çš„å…³ç³»æ˜¯ç”¨ç»§æ‰¿æ¥è¡¨è¾¾çš„ï¼Œè€Œâ€œhas-aâ€ï¼ˆæœ‰ä¸€ä¸ªï¼‰çš„å…³ç³»åˆ™æ˜¯ç”¨ç»„åˆæ¥è¡¨è¾¾çš„ã€‚
åˆ°åº•æ˜¯è¯¥ç”¨ç»„åˆè¿˜æ˜¯ç»§æ‰¿ï¼Œä¸€ä¸ªæœ€æ¸…æ™°çš„åˆ¤æ–­æ–¹æ³•å°±æ˜¯é—®ä¸€é—®è‡ªå·±æ˜¯å¦éœ€è¦ä»æ–°ç±»å‘åŸºç±»è¿›è¡Œå‘ä¸Šè½¬å‹ï¼Œéœ€è¦çš„è¯å°±ç”¨ç»§æ‰¿ï¼Œä¸éœ€è¦çš„è¯å°±ç”¨ç»„åˆæ–¹å¼ã€‚</p>
<h3 id="8-finalå…³é”®å­—">8. finalå…³é”®å­—</h3>

<p>å¯¹finalå…³é”®å­—çš„è¯¯è§£ å½“finalä¿®é¥°çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œå®ƒæŒ‡çš„æ˜¯æ•°å€¼æ’å®šä¸å˜ï¼ˆå°±æ˜¯ç¼–è¯‘æœŸå¸¸é‡ï¼Œå¦‚æœæ˜¯static finalä¿®é¥°ï¼Œåˆ™å¼ºè°ƒåªæœ‰ä¸€ä»½ï¼‰ï¼Œè€Œå¯¹å¯¹è±¡å¼•ç”¨è€Œä¸æ˜¯åŸºæœ¬ç±»å‹è¿ç”¨finalæ—¶ï¼Œå…¶å«ä¹‰ä¼šæœ‰ä¸€ç‚¹ä»¤äººè¿·æƒ‘ï¼Œå› ä¸ºç”¨äºå¯¹è±¡å¼•ç”¨æ—¶ï¼Œfinalä½¿å¼•ç”¨æ’å®šä¸å˜ï¼Œä¸€æ—¦å¼•ç”¨è¢«åˆå§‹åŒ–æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œå°±æ— æ³•å†æŠŠå®ƒæŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ã€‚ç„¶è€Œï¼Œå¯¹è±¡å…¶è‡ªèº«å´æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ï¼ŒJavaå¹¶æœªæä¾›ä½¿ä»»ä½•å¯¹è±¡æ’å®šä¸å˜çš„é€”å¾„ï¼ˆä½†å¯ä»¥è‡ªå·±ç¼–å†™ç±»ä»¥å–å¾—ä½¿å¯¹è±¡æ’å®šä¸å˜çš„æ•ˆæœï¼‰ï¼Œè¿™ä¸€é™åˆ¶åŒæ ·é€‚ç”¨æ•°ç»„ï¼Œå®ƒä¹Ÿæ˜¯å¯¹è±¡ã€‚
ä½¿ç”¨finalæ–¹æ³•çœŸçš„å¯ä»¥æé«˜ç¨‹åºæ•ˆç‡å—ï¼Ÿ å°†ä¸€ä¸ªæ–¹æ³•è®¾æˆfinalåï¼Œç¼–è¯‘å™¨å°±å¯ä»¥æŠŠå¯¹é‚£ä¸ªæ–¹æ³•çš„æ‰€æœ‰è°ƒç”¨éƒ½ç½®å…¥â€œåµŒå…¥â€è°ƒç”¨é‡Œã€‚åªè¦ç¼–è¯‘å™¨å‘ç°ä¸€ä¸ªfinalæ–¹æ³•è°ƒç”¨ï¼Œå°±ä¼šï¼ˆæ ¹æ®å®ƒè‡ªå·±çš„åˆ¤æ–­ï¼‰å¿½ç•¥ä¸ºæ‰§è¡Œæ–¹æ³•è°ƒç”¨æœºåˆ¶è€Œé‡‡å–çš„å¸¸è§„ä»£ç æ’å…¥æ–¹æ³•ï¼ˆå°†è‡ªå˜é‡å‹å…¥å †æ ˆï¼›è·³è‡³æ–¹æ³•ä»£ç å¹¶æ‰§è¡Œå®ƒï¼›è·³å›æ¥ï¼›æ¸…é™¤å †æ ˆè‡ªå˜é‡ï¼›æœ€åå¯¹è¿”å›å€¼è¿›è¡Œå¤„ç†ï¼‰ã€‚ç›¸åï¼Œå®ƒä¼šç”¨æ–¹æ³•ä¸»ä½“å†…å®é™…ä»£ç çš„ä¸€ä¸ªå‰¯æœ¬æ¥æ›¿æ¢æ–¹æ³•è°ƒç”¨ã€‚è¿™æ ·åšå¯é¿å…æ–¹æ³•è°ƒç”¨æ—¶çš„ç³»ç»Ÿå¼€é”€ã€‚å½“ç„¶ï¼Œè‹¥æ–¹æ³•ä½“ç§¯å¤ªå¤§ï¼Œé‚£ä¹ˆç¨‹åºä¹Ÿä¼šå˜å¾—é›è‚¿ï¼Œå¯èƒ½å—åˆ°åˆ°ä¸åˆ°åµŒå…¥ä»£ç æ‰€å¸¦æ¥çš„ä»»ä½•æ€§èƒ½æå‡ã€‚å› ä¸ºä»»ä½•æå‡éƒ½è¢«èŠ±åœ¨æ–¹æ³•å†…éƒ¨çš„æ—¶é—´æŠµæ¶ˆäº†ã€‚
åœ¨æœ€è¿‘çš„Javaç‰ˆæœ¬ä¸­ï¼Œè™šæ‹Ÿæœºï¼ˆç‰¹åˆ«æ˜¯hotspotæŠ€æœ¯ï¼‰èƒ½è‡ªåŠ¨ä¾¦æµ‹è¿™äº›æƒ…å†µï¼Œå¹¶é¢‡ä¸ºâ€œæ˜æ™ºâ€åœ°å†³å®šæ˜¯å¦åµŒå…¥ä¸€ä¸ªfinal æ–¹æ³•ã€‚ç„¶è€Œï¼Œæœ€å¥½è¿˜æ˜¯ä¸è¦å®Œå…¨ç›¸ä¿¡ç¼–è¯‘å™¨èƒ½æ­£ç¡®åœ°ä½œå‡ºæ‰€æœ‰åˆ¤æ–­ã€‚é€šå¸¸ï¼Œåªæœ‰åœ¨æ–¹æ³•çš„ä»£ç é‡éå¸¸å°‘ï¼Œæˆ–è€…æƒ³æ˜ç¡®ç¦æ­¢æ–¹æ³•è¢«è¦†ç›–çš„æ—¶å€™ï¼Œæ‰åº”è€ƒè™‘å°†ä¸€ä¸ªæ–¹æ³•è®¾ä¸ºfinalã€‚</p>

<p>ç±»å†…æ‰€æœ‰private æ–¹æ³•éƒ½è‡ªåŠ¨æˆä¸ºfinalã€‚ç”±äºæˆ‘ä»¬ä¸èƒ½è®¿é—®ä¸€ä¸ªprivate æ–¹æ³•ï¼Œæ‰€ä»¥å®ƒç»å¯¹ä¸ä¼šè¢«å…¶ä»–æ–¹æ³•è¦†ç›–ï¼ˆè‹¥å¼ºè¡Œè¿™æ ·åšï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºé”™è¯¯æç¤ºï¼‰ã€‚å¯ä¸ºä¸€ä¸ªprivateæ–¹æ³•æ·»åŠ finalæŒ‡ç¤ºç¬¦ï¼Œä½†å´ä¸èƒ½ä¸ºé‚£ä¸ªæ–¹æ³•æä¾›ä»»ä½•é¢å¤–çš„å«ä¹‰ã€‚</p>

<h3 id="9-ç­–ç•¥è®¾è®¡æ¨¡å¼ä¸é€‚é…å™¨æ¨¡å¼çš„åŒºåˆ«">9. ç­–ç•¥è®¾è®¡æ¨¡å¼ä¸é€‚é…å™¨æ¨¡å¼çš„åŒºåˆ«</h3>

<p>ç­–ç•¥è®¾è®¡æ¨¡å¼ åˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿæ ¹æ®æ‰€ä¼ é€’çš„å‚æ•°å¯¹è±¡çš„ä¸åŒè€Œå…·æœ‰ä¸åŒè¡Œä¸ºçš„æ–¹æ³•ï¼Œè¢«ç§°ä¸ºç­–ç•¥è®¾è®¡æ¨¡å¼ï¼Œè¿™ç±»æ–¹æ³•åŒ…å«æ‰€è¦æ‰§è¡Œçš„ç®—æ³•ä¸­å›ºå®šä¸å˜çš„éƒ¨åˆ†ï¼Œè€Œâ€œç­–ç•¥â€åŒ…å«å˜åŒ–çš„éƒ¨åˆ†ã€‚ç­–ç•¥å°±æ˜¯ä¼ é€’è¿›å»çš„å‚æ•°å¯¹è±¡ï¼Œå®ƒåŒ…å«è¦æ‰§è¡Œçš„ä»£ç ã€‚
é€‚é…å™¨æ¨¡å¼ åœ¨ä½ æ— æ³•ä¿®æ”¹ä½ æƒ³è¦ä½¿ç”¨çš„ç±»æ—¶ï¼Œå¯ä»¥ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ï¼Œé€‚é…å™¨ä¸­çš„ä»£ç å°†æ¥å—ä½ æ‰€æ‹¥æœ‰çš„æ¥å£ï¼Œå¹¶äº§ç”Ÿä½ æ‰€éœ€è¦çš„æ¥å£ã€‚</p>

<h3 id="10-å†…éƒ¨ç±»">10. å†…éƒ¨ç±»</h3>

<p>å†…éƒ¨ç±»ä¸ç»„åˆæ˜¯å®Œå…¨ä¸åŒçš„æ¦‚å¿µï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚</p>

<p>ä¸ºä»€ä¹ˆéœ€è¦å†…éƒ¨ç±»ï¼Ÿ â€” ä¸»è¦æ˜¯è§£å†³äº†å¤šç»§æ‰¿çš„é—®é¢˜ï¼Œç»§æ‰¿å…·ä½“æˆ–æŠ½è±¡ç±»</p>

<p>ä¸€èˆ¬æ¥è¯´ï¼Œå†…éƒ¨ç±»ç»§æ‰¿è‡ªæŸä¸ªç±»æˆ–å®ç°æŸä¸ªæ¥å£ï¼Œå†…éƒ¨ç±»çš„ä»£ç æ“ä½œåˆ›å»ºå®ƒçš„å¤–å›´ç±»çš„å¯¹è±¡ã€‚æ‰€ä»¥å¯ä»¥è®¤ä¸ºå†…éƒ¨ç±»æä¾›äº†æŸç§è¿›å…¥å…¶å¤–å›´ç±»çš„çª—å£ã€‚
å†…éƒ¨ç±»æœ€å¸å¼•äººçš„åŸå› æ˜¯ï¼šæ¯ä¸ªå†…éƒ¨ç±»éƒ½èƒ½ç‹¬ç«‹åœ°ç»§æ‰¿è‡ªä¸€ä¸ªï¼ˆæ¥å£çš„ï¼‰å®ç°ï¼Œæ‰€ä»¥æ— è®ºå¤–å›´ç±»æ˜¯å¦å·²ç»ç»§æ‰¿äº†æŸä¸ªï¼ˆæ¥å£çš„ï¼‰å®ç°ï¼Œå¯¹äºå†…éƒ¨ç±»éƒ½æ²¡æœ‰å½±å“ã€‚
å¦‚æœæ²¡æœ‰å†…éƒ¨ç±»æä¾›çš„ã€å¯ä»¥ç»§æ‰¿å¤šä¸ªå…·ä½“çš„æˆ–æŠ½è±¡çš„ç±»çš„èƒ½åŠ›ï¼Œä¸€äº›è®¾è®¡ä¸ç¼–ç¨‹é—®é¢˜å°±å¾ˆéš¾è§£å†³ã€‚ä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œå†…éƒ¨ç±»ä½¿å¾—å¤šé‡ç»§æ‰¿çš„è§£å†³æ–¹æ¡ˆå˜å¾—å®Œæ•´ã€‚æ¥å£è§£å†³äº†éƒ¨åˆ†é—®é¢˜ï¼Œè€Œå†…éƒ¨ç±»æœ‰æ•ˆçš„å®ç°äº†â€œå¤šé‡ç»§æ‰¿â€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå†…éƒ¨ç±»å…è®¸ç»§æ‰¿å¤šä¸ªéæ¥å£ç±»å‹ã€‚
è€ƒè™‘è¿™æ ·ä¸€ç§æƒ…å½¢ï¼šå¦‚æœå¿…é¡»åœ¨ä¸€ä¸ªç±»ä¸­ä»¥æŸç§æ–¹å¼å®ç°ä¸¤ä¸ªæ¥å£ã€‚ç”±äºæ¥å£çš„çµæ´»æ€§ï¼Œä½ æœ‰ä¸¤ç§é€‰æ‹©ï¼šä½¿ç”¨å•ä¸€ç±»æˆ–è€…ä½¿ç”¨å†…éƒ¨ç±»ã€‚ä½†å¦‚æœæ‹¥æœ‰çš„æ˜¯æŠ½è±¡çš„ç±»æˆ–å…·ä½“çš„ç±»ï¼Œè€Œä¸æ˜¯æ¥å£ï¼Œé‚£å°±åªèƒ½ä½¿ç”¨å†…éƒ¨ç±»æ‰èƒ½å®ç°å¤šé‡ç»§æ‰¿ã€‚</p>

<p>ä½¿ç”¨å†…éƒ¨ç±»ï¼Œè¿˜å¯ä»¥è·å¾—å…¶ä»–ä¸€äº›ç‰¹æ€§ï¼š - å†…éƒ¨ç±»å¯ä»¥æœ‰å¤šä¸ªå®ä¾‹ï¼Œæ¯ä¸ªå®ä¾‹éƒ½æœ‰è‡ªå·±çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¹¶ä¸”ä¸å…¶å¤–å›´ç±»å¯¹è±¡çš„ä¿¡æ¯ç›¸äº’ç‹¬ç«‹ã€‚ - åœ¨å•ä¸ªå¤–å›´ç±»ä¸­ï¼Œå¯ä»¥è®©å¤šä¸ªå†…éƒ¨ç±»ä»¥ä¸åŒçš„æ–¹å¼å®ç°åŒä¸€ä¸ªæ¥å£æˆ–ç»§æ‰¿åŒä¸€ä¸ªç±»ã€‚ - åˆ›å»ºå†…éƒ¨ç±»å¯¹è±¡çš„æ—¶åˆ»å¹¶ä¸ä¾èµ–äºå¤–å›´ç±»å¯¹è±¡çš„åˆ›å»ºã€‚ - å†…éƒ¨ç±»å¹¶æ²¡æœ‰ä»¤äººè¿·æƒ‘çš„is-aå…³ç³»ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å®ä½“ã€‚</p>

<h3 id="11-stringç±»å‹--ä¸å¯å˜">11. Stringç±»å‹ â€” ä¸å¯å˜</h3>

<p>ç”¨äºStringçš„â€œ+â€ä¸â€œ+=â€æ˜¯Javaä¸­ä»…æœ‰çš„ä¸¤ä¸ªé‡è½½è¿‡çš„æ“ä½œç¬¦ï¼Œè€ŒJavaå¹¶ä¸å…è®¸ç¨‹åºå‘˜é‡è½½ä»»ä½•æ“ä½œç¬¦ã€‚
è€ƒè™‘åˆ°æ•ˆç‡å› ç´ ï¼Œç¼–è¯‘å™¨ä¼šå¯¹Stringçš„å¤šæ¬¡+æ“ä½œè¿›è¡Œä¼˜åŒ–ï¼Œä¼˜åŒ–ä½¿ç”¨StringBuilderæ“ä½œï¼ˆjavap -c classå­—èŠ‚ç æ–‡ä»¶å å‘½ä»¤æŸ¥çœ‹å…·ä½“ä¼˜åŒ–è¿‡ç¨‹ï¼‰ã€‚è¿™è®©ä½ è§‰å¾—å¯ä»¥éšæ„ä½¿ç”¨Stringå¯¹è±¡ï¼Œåæ­£ç¼–è¯‘å™¨ä¼šä¸ºä½ è‡ªåŠ¨åœ°ä¼˜åŒ–æ€§èƒ½ã€‚ä½†ç¼–è¯‘å™¨èƒ½ä¼˜åŒ–åˆ°ä»€ä¹ˆç¨‹åº¦è¿˜ä¸å¥½è¯´ï¼Œä¸ä¸€å®šèƒ½ä¼˜åŒ–åˆ°ä½¿ç”¨StringBuilderä»£æ›¿Stringç›¸åŒçš„æ•ˆæœã€‚æ¯”å¦‚ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class WitherStringBuilder {
	public String implicit(String[] fields) {
		String result = "";
		for(int i = 0; i &lt; fields.length; i++)
			result += fields[i];
		return result;
	}
	
	public String explicit(String[] fields) {
		StringBuilder result = new StringBuilder();
		for(int i = 0; i &lt; fields.length; i++)
			result.append(fields[i]);
		return result.toString();
	}
}
</code></pre></div></div>
<p>è¿è¡Œjavap -c WitherStringBuilderï¼Œå¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæ–¹æ³•å¯¹åº”çš„å­—èŠ‚ç ã€‚ implicitæ–¹æ³•ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public java.lang.String implicit(java.lang.String[]); Code: 0: ldc #16 // String 2: astore_2 3: iconst_0 4: istore_3 5: goto 32 8: new #18 // class java/lang/StringBuilder 11: dup 12: aload_2 13: invokestatic #20 // Method java/lang/String.valueOf:( Ljava/lang/Object;)Ljava/lang/String; 16: invokespecial #26 // Method java/lang/StringBuilder."&lt; init&gt;":(Ljava/lang/String;)V 19: aload_1 20: iload_3 21: aaload 22: invokevirtual #29 // Method java/lang/StringBuilder.ap pend:(Ljava/lang/String;)Ljava/lang/StringBuilder; 25: invokevirtual #33 // Method java/lang/StringBuilder.to String:()Ljava/lang/String; 28: astore_2 29: iinc 3, 1 32: iload_3 33: aload_1 34: arraylength 35: if_icmplt 8 38: aload_2 39: areturn public java.lang.String implicit(java.lang.String[]); Code: 0: ldc #16 // String 2: astore_2 3: iconst_0 4: istore_3 5: goto 32 8: new #18 // class java/lang/StringBuilder 11: dup 12: aload_2 13: invokestatic #20 // Method java/lang/String.valueOf:( Ljava/lang/Object;)Ljava/lang/String; 16: invokespecial #26 // Method java/lang/StringBuilder."&lt; init&gt;":(Ljava/lang/String;)V 19: aload_1 20: iload_3 21: aaload 22: invokevirtual #29 // Method java/lang/StringBuilder.ap pend:(Ljava/lang/String;)Ljava/lang/StringBuilder; 25: invokevirtual #33 // Method java/lang/StringBuilder.to String:()Ljava/lang/String; 28: astore_2 29: iinc 3, 1 32: iload_3 33: aload_1 34: arraylength 35: if_icmplt 8 38: aload_2 39: areturn
</code></pre></div></div>
<p>å¯ä»¥å‘ç°ï¼ŒStringBuilderæ˜¯åœ¨å¾ªç¯ä¹‹å†…æ„é€ çš„ï¼Œè¿™æ„å‘³ç€æ¯ç»è¿‡å¾ªç¯ä¸€æ¬¡ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„StringBuilderå¯¹è±¡ã€‚</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>explicitæ–¹æ³•ï¼š

public java.lang.String explicit(java.lang.String[]); Code: 0: new #18 // class java/lang/StringBuilder 3: dup 4: invokespecial #45 // Method java/lang/StringBuilder."&lt; init&gt;":()V 7: astore_2 8: iconst_0 9: istore_3 10: goto 24 13: aload_2 14: aload_1 15: iload_3 16: aaload 17: invokevirtual #29 // Method java/lang/StringBuilder.ap pend:(Ljava/lang/String;)Ljava/lang/StringBuilder; 20: pop 21: iinc 3, 1 24: iload_3 25: aload_1 26: arraylength 27: if_icmplt 13 30: aload_2 31: invokevirtual #33 // Method java/lang/StringBuilder.to String:()Ljava/lang/String; 34: areturn }
</code></pre></div></div>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸ä»…å¾ªç¯éƒ¨åˆ†çš„ä»£ç æ›´ç®€çŸ­ã€æ›´ç®€å•ï¼Œè€Œä¸”å®ƒåªç”Ÿæˆäº†ä¸€ä¸ªStringBuilderå¯¹è±¡ã€‚æ˜¾å¼çš„åˆ›å»ºStringBuilderè¿˜å…è®¸ä½ é¢„å…ˆä¸ºå…¶æŒ‡å®šå¤§å°ã€‚å¦‚æœä½ å·²ç»çŸ¥é“æœ€ç»ˆçš„å­—ç¬¦ä¸²å¤§æ¦‚æœ‰å¤šé•¿ï¼Œé‚£é¢„å…ˆæŒ‡å®šStringBuilderçš„å¤§å°å¯ä»¥é¿å…å¤šæ¬¡é‡æ–°åˆ†é…ç¼“å†²ã€‚</p>

<h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>å› æ­¤ï¼Œå½“ä½ ä¸ºä¸€ä¸ªç±»é‡å†™toString()æ–¹æ³•æ—¶ï¼Œå¦‚æœå­—ç¬¦ä¸²æ“ä½œæ¯”è¾ƒç®€å•ï¼Œé‚£å°±å¯ä»¥ä¿¡èµ–ç¼–è¯‘å™¨ï¼Œå®ƒä¼šä¸ºä½ åˆç†åœ°æ„é€ æœ€ç»ˆçš„å­—ç¬¦ä¸²ç»“æœã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ è¦åœ¨toString()æ–¹æ³•ä¸­ä½¿ç”¨å¾ªç¯ï¼Œé‚£ä¹ˆæœ€å¥½è‡ªå·±åˆ›å»ºä¸€ä¸ªStringBuilderå¯¹è±¡ï¼Œç”¨å®ƒæ¥æ„é€ æœ€ç»ˆçš„ç»“æœã€‚</p>

<p>System.out.printf()å’ŒSystem.out.format()æ–¹æ³•æ¨¡ä»¿è‡ªCçš„printfï¼Œå¯ä»¥æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œä¸¤è€…æ˜¯å®Œå…¨ç­‰ä»·çš„ã€‚
Javaä¸­ï¼Œæ‰€æœ‰æ–°çš„æ ¼å¼åŒ–åŠŸèƒ½éƒ½ç”±java.util.Formatterç±»å¤„ç†ã€‚ String.format()æ–¹æ³•å‚è€ƒäº†Cä¸­çš„sprintf()æ–¹æ³•ï¼Œä»¥ç”Ÿæˆæ ¼å¼åŒ–çš„Stringå¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªstaticæ–¹æ³•ï¼Œå®ƒæ¥å—ä¸Formatter.format()æ–¹æ³•ä¸€æ ·çš„å‚æ•°ï¼Œä½†è¿”å›ä¸€ä¸ªStringå¯¹è±¡ã€‚å½“ä½ åªéœ€ä½¿ç”¨format()æ–¹æ³•ä¸€æ¬¡çš„æ—¶å€™ï¼Œè¯¥æ–¹æ³•å¾ˆæ–¹ä¾¿ã€‚</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java import java.util.Arrays; import java.util.Formatter;

public class SimpleFormat {

	public static void main(String[] args) {
		int x = 5;
		double y = 5.324667;
		System.out.printf("Row 1: [%d %f]\n", x, y);
		System.out.format("Row 1: [%d %f]\n", x, y);
		
		Formatter f = new Formatter(System.out);
		f.format("Row 1: [%d %f]\n", x, y);
		
		String str = String.format("Row 1: [%d %f]\n", x, y);
		System.out.println(str);
		
		Integer[][] a = {
			{1, 2, 3}, {4, 5, 6},
			{7, 8, 3}, {9, 10, 6}
		};
		System.out.println(Arrays.deepToString(a));
	}
}
</code></pre></div></div>
<h3 id="12-åºåˆ—åŒ–æ§åˆ¶">12. åºåˆ—åŒ–æ§åˆ¶</h3>

<p>å½“æˆ‘ä»¬å¯¹åºåˆ—åŒ–è¿›è¡Œæ§åˆ¶æ—¶ï¼Œå¯èƒ½æŸä¸ªç‰¹å®šå­å¯¹è±¡ä¸æƒ³è®©Javaåºåˆ—åŒ–æœºåˆ¶è‡ªåŠ¨ä¿å­˜ä¸æ¢å¤ã€‚å¦‚æœå­å¯¹è±¡è¡¨ç¤ºçš„æ˜¯æˆ‘ä»¬ä¸å¸Œæœ›å°†å…¶åºåˆ—åŒ–çš„æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç ï¼‰ï¼Œé€šå¸¸ä¼šé¢ä¸´è¿™ç§æƒ…å†µã€‚å³ä½¿å¯¹è±¡ä¸­çš„è¿™äº›ä¿¡æ¯æ˜¯privateå±æ€§ï¼Œä¸€ç»åºåˆ—åŒ–å¤„ç†ï¼Œäººä»¬å°±å¯ä»¥é€šè¿‡è¯»å–æ–‡ä»¶æˆ–è€…æ‹¦æˆªç½‘ç»œä¼ è¾“çš„æ–¹å¼æ¥è®¿é—®åˆ°å®ƒã€‚æœ‰ä¸¤ç§åŠæ³•å¯ä»¥é˜²æ­¢å¯¹è±¡çš„æ•æ„Ÿéƒ¨åˆ†è¢«åºåˆ—åŒ–ï¼š</p>

<p>å®ç°Externalizableä»£æ›¿å®ç°Serializableæ¥å£æ¥å¯¹åºåˆ—åŒ–è¿‡ç¨‹è¿›è¡Œæ§åˆ¶ï¼ŒExternalizableç»§æ‰¿äº†Serializableæ¥å£ï¼ŒåŒæ—¶å¢æ·»äº†ä¸¤ä¸ªæ–¹æ³•ï¼šwriteExternal()å’ŒreadExternal()ã€‚
ä¸¤è€…åœ¨ååºåˆ—åŒ–æ—¶çš„åŒºåˆ«ï¼š</p>

<p>å¯¹Serializableå¯¹è±¡ååºåˆ—åŒ–æ—¶ï¼Œ<strong>ç”±äºSerializableå¯¹è±¡å®Œå…¨ä»¥å®ƒå­˜å‚¨çš„äºŒè¿›åˆ¶ä½ä¸ºåŸºç¡€æ¥æ„é€ ï¼Œå› æ­¤å¹¶ä¸ä¼šè°ƒç”¨ä»»ä½•æ„é€ å‡½æ•°ï¼Œ</strong> å› æ­¤Serializableç±»æ— éœ€é»˜è®¤æ„é€ å‡½æ•°ï¼Œä½†æ˜¯å½“Serializableç±»çš„çˆ¶ç±»æ²¡æœ‰å®ç°Serializableæ¥å£æ—¶ï¼Œååºåˆ—åŒ–è¿‡ç¨‹ä¼šè°ƒç”¨çˆ¶ç±»çš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œå› æ­¤è¯¥çˆ¶ç±»å¿…éœ€æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸ã€‚
å¯¹<strong>Externalizable</strong>å¯¹è±¡ååºåˆ—åŒ–æ—¶ï¼Œä¼šå…ˆè°ƒç”¨ç±»çš„ä¸å¸¦å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œè¿™æ˜¯æœ‰åˆ«äºé»˜è®¤ååºåˆ—æ–¹å¼çš„ã€‚å¦‚æœæŠŠç±»çš„ä¸å¸¦å‚æ•°çš„æ„é€ æ–¹æ³•åˆ é™¤ï¼Œæˆ–è€…æŠŠè¯¥æ„é€ æ–¹æ³•çš„è®¿é—®æƒé™è®¾ç½®ä¸ºprivateã€é»˜è®¤æˆ–protectedçº§åˆ«ï¼Œä¼šæŠ›å‡ºjava.io.InvalidException: no valid constructorå¼‚å¸¸ï¼Œå› æ­¤<strong>Externalizable</strong>å¯¹è±¡å¿…é¡»æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œè€Œä¸”å¿…éœ€æ˜¯publicçš„ã€‚
<strong>Externalizable</strong>çš„æ›¿ä»£æ–¹æ³•ï¼šå¦‚æœä¸æ˜¯ç‰¹åˆ«åšæŒå®ç°Externalizableæ¥å£ï¼Œé‚£ä¹ˆè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥å®ç°Serializableæ¥å£ï¼Œå¹¶æ·»åŠ writeObject()å’ŒreadObject()çš„æ–¹æ³•ã€‚ä¸€æ—¦å¯¹è±¡è¢«åºåˆ—åŒ–æˆ–è€…é‡æ–°è£…é…ï¼Œå°±ä¼šåˆ†åˆ«è°ƒç”¨é‚£ä¸¤ä¸ªæ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æä¾›äº†è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå°±ä¼šä¼˜å…ˆä½¿ç”¨å®ƒä»¬ï¼Œè€Œä¸è€ƒè™‘é»˜è®¤çš„åºåˆ—åŒ–æœºåˆ¶ã€‚</p>

<p>è¿™äº›æ–¹æ³•å¿…é¡»å«æœ‰ä¸‹åˆ—å‡†ç¡®çš„ç­¾åï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private void writeObject(ObjectOutputStream stream) 
        throws IOException;
private void readObject(ObjectInputStream stream)
        throws IOException, ClassNotFoundException
</code></pre></div></div>
<p>å¯ä»¥ç”¨transientå…³é”®å­—é€ä¸ªå­—æ®µåœ°å…³é—­åºåˆ—åŒ–ï¼Œå®ƒçš„æ„æ€æ˜¯<strong>â€œä¸ç”¨éº»çƒ¦ä½ ä¿å­˜æˆ–æ¢å¤æ•°æ®â€”æˆ‘è‡ªå·±ä¼šå¤„ç†çš„â€</strong>ã€‚ç”±äºExternalizableå¯¹è±¡åœ¨é»˜è®¤æƒ…å†µä¸‹ä¸ä¿å­˜å®ƒä»¬çš„ä»»ä½•å­—æ®µï¼Œæ‰€ä»¥transientå…³é”®å­—åªèƒ½å’ŒSerializableå¯¹è±¡ä¸€èµ·ä½¿ç”¨ã€‚</p>

:ET